name: Taller CI Pipeline

on:
  push:
    branches:
      - main
    paths:
      - "index.html"
      - ".github/workflows/**"
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: 1) Checkout del código
        uses: actions/checkout@v4

      - name: 2) Verificar que index.html exista
        run: |
          if [ ! -f index.html ]; then
            echo "ERROR: index.html no se encontró en la raíz del repo."
            ls -la
            exit 1
          fi
          echo "index.html encontrado."

      - name: 3) Mostrar contenido de index.html (para debug)
        run: |
          echo "---- inicio index.html ----"
          sed -n '1,200p' index.html || true
          echo "---- fin index.html ----"

      - name: 4) Lint/Check: buscar la palabra 'Rock'
        run: |
          echo "Buscando 'Rock' en index.html..."
          if ! grep -n "Rock" index.html; then
            echo "ERROR: 'Rock' no encontrado."
            exit 1
          fi
          echo "'Rock' encontrado."

      - name: 5) UnitCheck: buscar 'EventFlow'
        run: |
          echo "Buscando 'EventFlow' en index.html..."
          if ! grep -n "EventFlow" index.html; then
            echo "ERROR: 'EventFlow' no encontrado."
            exit 1
          fi
          echo "'EventFlow' encontrado."

      - name: 6) Resultado
        run: echo "Todas las comprobaciones pasaron ✅"
